[{"content":"问题由来 RFC规定：http 默认端口号 80，https 则是使用默认端口号 443。\n当浏览器请求一个 url，比如https://exmaple.com，就会去连接默认的443端口。\n要想通过指定端口连接，需要显示指定，比如https://exmaple.com:8848，这样就会通过指定的8848端口发起连接。\n家庭宽带的80与443端口都被运营商封掉了，所以要开放内网服务供外部访问，需要使用非标准端口。\n访问的时候需要显示指定端口号，这样 url 看起来很丑，当然要觉得无所谓，后面内容就不用看了。\n解决办法 之前解决这个问题可以做302跳转或者套代理中转，我的评价是：治标不治本，还不如不搞。\n现在多了一种办法，就是为域名添加 https 解析。\n这里以 cloudflare 为例说明：\n添加一条这样的 https 记录。\n这样，当浏览器访问https://exmaple.com的时候，会根据https记录里的 port 字段来发起连接，这样就不需要显示指定端口。\n不过现在这个时间，还没有成为标准，已知支持的浏览器只有 Safari 与 Firefox。\nFirefox好像得在设置里开启DoH才可以，Safari则不用做设置。\n","date":"2025-11-04T17:21:02+08:00","permalink":"http://localhost:1313/p/%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E6%B7%BB%E5%8A%A0https%E8%AE%B0%E5%BD%95%E5%AE%9E%E7%8E%B0%E5%85%8D%E7%AB%AF%E5%8F%A3%E5%8F%B7%E8%AE%BF%E9%97%AE%E9%9D%9E%E6%A0%87%E5%87%86%E7%AB%AF%E5%8F%A3http%E6%9C%8D%E5%8A%A1/","title":"域名解析添加https记录，实现免端口号访问非标准端口http服务"},{"content":"编译ffmpeg添加libaribcaption libaribcaption 1 2 3 4 5 6 cd libaribcaption mkdir build cd build cmake .. -DCMAKE_BUILD_TYPE=Release cmake --build . -j8 cmake --install . ffmpeg 1 2 3 4 git clone https://git.ffmpeg.org/ffmpeg.git cd ffmpeg ./configure --enable-libaribcaption --enable-gpl --enable-nonfree sudo make -j$(nproc) 提取字幕 输出ass字幕：\n1 ./ffmpeg -analyzeduration 10MB -probesize 10MB -fix_sub_duration -ignore_background 1 -itsoffset 5 -i EPXXX.ts -c:s ass EPXXX.ass 输出srt字幕：\n1 ./ffmpeg -analyzeduration 10MB -probesize 10MB -fix_sub_duration -ignore_background 1 -itsoffset 5 -i EPXXX.ts -c:s text EPXXX.srt 调整字幕缩放(ass) ts文件分辨率1440*1080，比例4:3，提取出来的字幕16:9，某些播放器直接放的话，字幕有点扁平。\n方法一 1 sed -i \u0026#39;s/100,100/75,100/\u0026#39; subtitle.ass 方法二 用aegisub的Resample Resolution工具调整分辨率为1440*1080\n1 2 3 4 5 6 7 8 9 [Script Info] ScriptType: v4.00+ ScaledBorderAndShadow: yes PlayResX: 1440 PlayResY: 1080 LayoutResX: 960 LayoutResY: 540 YCbCr Matrix: TV.709 WrapStyle: 0 ","date":"2025-02-16T18:25:07+08:00","permalink":"http://localhost:1313/p/%E4%BB%8Ets%E6%96%87%E4%BB%B6%E6%8F%90%E5%8F%96arib%E5%AD%97%E5%B9%95/","title":"从ts文件提取arib字幕"},{"content":"在企业微信的应用配置中，需要设置“可信 IP”或绑定已认证的域名。对于个人用户，通常只能选择绑定 IP 地址。家用宽带要么没有公网，要么公网 IP 是动态分配的，每次重新拨号后可能会获得一个新的 IP，这意味着需要频繁地更新“可信 IP”设置，非常不方便。\n考虑将原来的数据通信路径：\n去程：微信客户端 → 腾讯服务器 → NAS\n回程：NAS → 腾讯服务器 → 微信客户端\n通过引入 VPS 后，变为以下路径：\n去程：微信客户端 → 腾讯服务器 → NAS（有公网的情况）\n回程：NAS → VPS → 腾讯服务器 → 微信客户端\n如此一来只需要绑定 VPS 的 IP，这里以 frp 为例进行配置，使用zerotier应该也能实现。\n服务端配置 安装frps 1 2 3 wget https://raw.githubusercontent.com/mvscode/frps-onekey/master/install-frps.sh -O ./install-frps.sh chmod 700 ./install-frps.sh ./install-frps.sh install 一直按enter即可。\n安装微信中转代理 1 2 3 4 5 6 7 8 9 apt upgrade -y \u0026amp;\u0026amp; apt install curl -y \u0026amp;\u0026amp; curl -fsSL https://get.docker.com -o get-docker.sh \u0026amp;\u0026amp; sh get-docker.sh \u0026amp;\u0026amp; timedatectl set-timezone Asia/Shanghai \u0026amp;\u0026amp; docker run -d \\ --name wxchat \\ --restart=always \\ -p 81:80 \\ ddsderek/wxchat:latest 客户端配置 docker 安装 frpc 编辑frpc.toml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 serverAddr = \u0026#34;\u0026#34; serverPort = 5443 auth.method = \u0026#34;token\u0026#34; auth.token = \u0026#34;\u0026#34; ##token log.to = \u0026#34;/frp/logs/frpc.log\u0026#34; log.level = \u0026#34;info\u0026#34; log.maxDays = 180 log.disablePrintColor = false [[proxies]] name = \u0026#34;moviepilot\u0026#34; type = \u0026#34;http\u0026#34; localIP = \u0026#34;1.1.1.1\u0026#34; ##moviepilot的局域网ip localPort = 3000 customDomains = [\u0026#34;\u0026#34;] ##不绑定域名的话可以直接填vps的ip transport.useEncryption = true transport.useCompression = false docker-compose 1 2 3 4 5 6 7 8 9 services: frpc: image: snowdreamtech/frpc:latest container_name: frpc restart: always network_mode: host volumes: - ./frpc.toml:/etc/frp/frpc.toml:ro - ./logs:/frp/logs 其他设置 moviepilot新增一条环境变量WECHAT_PROXY: http://qyapi.weixin.qq.com:81\n修改qyapi.weixin.qq.com的 host为vps的ip\n","date":"2024-10-18T22:37:44+08:00","permalink":"http://localhost:1313/p/moviepilot-vps-%E9%85%8D%E7%BD%AE%E5%BE%AE%E4%BF%A1%E6%B6%88%E6%81%AF%E9%80%9A%E7%9F%A5/","title":"Moviepilot \u0026 VPS 配置微信消息通知"}]